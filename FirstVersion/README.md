# Вариант 1 - API сервиса лизинга автомобилей

## Модели

**Машина**
- Марка (Ford, Mercedess, Toyota)
- Модель (Vesta, "001", "S")
- Категория (A, B, C, D)
- Год создания
- Статус (Свободна (по умолчанию), забронирована, в аренде)
- Стоимость аренды в день (Рандомное значение от 7000 до 15000)
- Дата передачи в аренду
- Город (в котором сейчас находится машина)
- Водитель 

**Компания**
- Название
- Список имеющихся машин
- Список сотрудников

**Пользователь**
- Логин
- Пароль
- Имя
- Роль (водитель, сотрудник)

**Водитель**
- Категория прав (A, B, C, D)
- Дата выдачи прав
- Город 
- Список арендованных машин

**Сотрудник компании**
- Список сданных автомобилей (история сделок, необходима для расчета зарплаты)
- Баланс ("зарплата" сотрудника, зависит от количества завершенных сделок)

## Методы API
1) _/login_ - вход в систему по логину и паролю. При успешной авторизации возвращать JWT-токен с информацией о роли, имени, и компании (если сотрудник) пользователя
2) _/auto/add_ - добавить новый автомобиль (обязательные поля "Категория", "Город", "Компания"). Возвращает информацию о созданном объекте. Доступно только авторизованным сотрудникам
3) _/auto/get/all_ - получить список всех свободных автомобилей (возвращать всю информацию по машине, кроме полей "Статус" и "Водитель")
4) _/auto/get?{category}&{city}_ - получить список всех свободных и забронированных автомобилей, отфильтрованных по заданной категории и городу (возвращать всю информацию по машине, кроме поля "Водитель")
5) _/auto/{id}/book_ - забронировать машину с заданным id. Возвращает статус-код операции
6) _/auto/{id}/lease_ - передать автомобиль в аренду. Возвращает всю информацию по этому автомобилю и ее водителю. Доступно только авторизованным сотрудникам.
7) _/auto/{id}/return_ - вернуть автомобиль. Возвращает стоимость услуги. Доступно только авторизованным сотрудникам 
8) _/employee/all/salary_ - рассчитать зарплату всех сотрудников. Возвращает словарь, где ключ - cотрудник, значение - зарплата.

## Особенности реализации
- Логика взаимодействия с автомобилями происходит в сервисе автомобилей
- Логика взаимодействия с сотрудниками происходит в сервисе сотрудников
- Логика взаимодействия с аутентификацией и авторизацией производится в сервисе пользователя. В случае отсутствия аутентификации выбрасывать код ошибки авторизации
- При создании JWT токена параметры issuer, audience можно оставить как пустые строки и не проверять их
- При добавлении нового автомобиля поле "Компания" задавать, используя информацию из JWT токена сотрудника
- При бронировании автомобиля выполнять все необходимые проверки (машина свободна, права водителя не просрочены, город, в котором находятся водитель и авто, совпадает)
- При передаче автомобиля в аренду меняется статус машины ("В аренде") и дата передачи в аренду (текущая дата), запись о приобретении прав добавляется автомобилю и водителю (внешние ключи в бд)
- При возврате автомобиля машина добавляется в список сотруднику, организовавшему сделку (для премии)
- Формула рассчета услуги аренды: стоимость аренды * количество дней в аренде
- Формула рассчета зарплаты: 15.000 (базовая ставка) + 0.1% от стоимости аренды (для каждого автомобиля)